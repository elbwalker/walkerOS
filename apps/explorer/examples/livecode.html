<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WalkerOS Explorer - Real Integration Demo</title>
    <style>
      body {
        font-family:
          system-ui,
          -apple-system,
          sans-serif;
        margin: 0;
        padding: 20px;
        background: #fafafa;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
      }

      h1 {
        color: #1f2937;
        margin-bottom: 10px;
      }

      .description {
        color: #6b7280;
        margin-bottom: 30px;
        font-size: 16px;
        line-height: 1.5;
      }

      .playground-container {
        height: 80vh;
        min-height: 600px;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        background: white;
        overflow: hidden;
      }

      .status {
        background: #f3f4f6;
        padding: 12px 16px;
        border-radius: 6px;
        margin-bottom: 20px;
        border-left: 4px solid #10b981;
      }

      .status-title {
        font-weight: 600;
        color: #059669;
        margin-bottom: 4px;
      }

      .status-description {
        color: #374151;
        font-size: 14px;
      }

      .feature-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 16px;
        margin: 20px 0;
      }

      .feature {
        background: white;
        padding: 16px;
        border-radius: 6px;
        border: 1px solid #e5e7eb;
      }

      .feature-title {
        font-weight: 600;
        color: #1f2937;
        margin-bottom: 8px;
      }

      .feature-description {
        color: #6b7280;
        font-size: 14px;
      }

      /* Theme Toggle Button */
      .theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        width: 44px;
        height: 44px;
        border: none;
        border-radius: 8px;
        background: white;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        transition: all 200ms ease;
        z-index: 1000;
      }

      .theme-toggle:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      /* Dark mode styles */
      [data-theme="dark"] {
        color-scheme: dark;
      }

      [data-theme="dark"] body {
        background: #0a0a0a;
        color: #fafafa;
      }

      [data-theme="dark"] h1 {
        color: #f9fafb;
      }

      [data-theme="dark"] .description {
        color: #9ca3af;
      }

      [data-theme="dark"] .playground-container {
        background: #18181b;
        border-color: #27272a;
      }

      [data-theme="dark"] .theme-toggle {
        background: #27272a;
        color: #fafafa;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      [data-theme="dark"] .theme-toggle:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
      }
    </style>
    <script src="../dist/explorer.js"></script>
  </head>
  <body>
    <!-- Theme Toggle Button -->
    <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
      <span id="theme-icon">‚òÄÔ∏è</span>
    </button>

    <div class="container">
      <h1>üöÄ WalkerOS Explorer - Real Integration Demo</h1>

      <div
        id="playground"
        class="playground-container"
        data-testid="livecode-explorer"
      ></div>
    </div>

    <script>
      // Theme Toggle Functionality
      function initThemeToggle() {
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = document.getElementById('theme-icon');
        const html = document.documentElement;

        // Get saved theme or default to light
        const savedTheme = localStorage.getItem('theme') || 'light';
        
        // Apply saved theme
        if (savedTheme === 'dark') {
          html.setAttribute('data-theme', 'dark');
          themeIcon.textContent = 'üåô';
        } else {
          html.removeAttribute('data-theme');
          themeIcon.textContent = '‚òÄÔ∏è';
        }

        // Toggle theme on button click
        themeToggle.addEventListener('click', () => {
          const currentTheme = html.getAttribute('data-theme');
          
          if (currentTheme === 'dark') {
            // Switch to light mode
            html.removeAttribute('data-theme');
            themeIcon.textContent = '‚òÄÔ∏è';
            localStorage.setItem('theme', 'light');
          } else {
            // Switch to dark mode
            html.setAttribute('data-theme', 'dark');
            themeIcon.textContent = 'üåô';
            localStorage.setItem('theme', 'dark');
          }
        });
      }

      // Initialize theme toggle immediately
      initThemeToggle();

      // Wait for the explorer bundle to load
      document.addEventListener('DOMContentLoaded', () => {
        try {
          const { createPlayground } = WalkerExplorer;

          if (!createPlayground) {
            throw new Error(
              'createPlayground function not found in WalkerExplorer',
            );
          }

          // Create playground with real walkerOS integration
          const playground = createPlayground(
            document.getElementById('playground'),
            {
              // Use example HTML that demonstrates various walkerOS features
              initialHTML: `<div class="product" data-elb="product" data-elbcontext="stage:listing,test:variant-a">
  <img src="https://via.placeholder.com/200x150/3b82f6/ffffff?text=Product" alt="Product Image" />
  <h3 data-elb-product="name:#innerText">Premium Wireless Headphones</h3>
  <p data-elb-product="price:149.99" class="price">$149.99</p>
  <p data-elb-product="category:electronics" class="category">Audio Equipment</p>
  
  <div class="buttons">
    <button 
      data-elbaction="click:view"
      data-elb-product="id:PROD-789"
      class="btn btn-primary"
    >
      View Details
    </button>
    <button 
      data-elbaction="click:add"
      data-elb-product="quantity:1"
      class="btn btn-success"
    >
      Add to Cart
    </button>
    <button 
      data-elbaction="click:wishlist"
      data-elb-product="list:favorites"
      class="btn btn-secondary"
    >
      ‚ô° Wishlist
    </button>
  </div>
  
  <div class="reviews" data-elb="review" data-elbcontext="section:social-proof">
    <h4>Customer Reviews</h4>
    <div 
      data-elbaction="click:expand"
      data-elb-review="rating:4.8,count:127"
      class="review-summary"
    >
      ‚≠ê 4.8/5 (127 reviews) - Click to expand
    </div>
  </div>
</div>`,

              // Enhanced CSS for better visual demo
              initialCSS: `.product {
  max-width: 400px;
  padding: 24px;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  font-family: system-ui, sans-serif;
  background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
}

img {
  width: 100%;
  border-radius: 8px;
  margin-bottom: 16px;
}

h3 {
  color: #1f2937;
  margin: 0 0 12px 0;
  font-size: 1.25rem;
  font-weight: 600;
}

.price {
  font-size: 24px;
  font-weight: bold;
  color: #059669;
  margin: 8px 0;
}

.category {
  color: #6b7280;
  font-size: 14px;
  margin-bottom: 20px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.buttons {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-bottom: 20px;
}

.btn {
  padding: 10px 16px;
  border: none;
  border-radius: 6px;
  font-weight: 500;
  cursor: pointer;
  transition: all 200ms ease;
  font-size: 14px;
}

.btn-primary {
  background: #3b82f6;
  color: white;
}

.btn-primary:hover {
  background: #2563eb;
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgb(59 130 246 / 0.3);
}

.btn-success {
  background: #10b981;
  color: white;
}

.btn-success:hover {
  background: #059669;
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgb(16 185 129 / 0.3);
}

.btn-secondary {
  background: #f3f4f6;
  color: #374151;
  border: 1px solid #d1d5db;
}

.btn-secondary:hover {
  background: #e5e7eb;
  transform: translateY(-1px);
}

.reviews {
  border-top: 1px solid #e5e7eb;
  padding-top: 16px;
}

.reviews h4 {
  color: #374151;
  margin: 0 0 12px 0;
  font-size: 1rem;
}

.review-summary {
  color: #6b7280;
  cursor: pointer;
  padding: 8px;
  border-radius: 4px;
  transition: background-color 200ms ease;
}

.review-summary:hover {
  background: #f9fafb;
  color: #374151;
}`,

              // Interactive JavaScript for demonstration
              initialJS: `// Enhanced walkerOS tracking demo
console.log('üöÄ Real walkerOS integration loaded!');
`,

              // Example mapping configuration for demonstration
              initialMapping: {
                product: {
                  view: {
                    name: 'view_item',
                    data: {
                      map: {
                        item_id: 'data.id',
                        item_name: 'data.name',
                        item_category: 'data.category',
                        currency: { value: 'USD' },
                        value: 'data.price',
                      },
                    },
                  },
                  add: {
                    name: 'add_to_cart',
                    data: {
                      map: {
                        item_id: 'data.id',
                        item_name: 'data.name',
                        currency: { value: 'USD' },
                        value: 'data.price',
                        quantity: 'data.quantity',
                      },
                    },
                  },
                  wishlist: {
                    name: 'add_to_wishlist',
                    data: {
                      map: {
                        item_id: 'data.id',
                        list_name: 'data.list',
                      },
                    },
                  },
                },
                review: {
                  expand: {
                    name: 'view_reviews',
                    data: {
                      map: {
                        rating: 'data.rating',
                        review_count: 'data.count',
                      },
                    },
                  },
                },
              },
            },
          );
        } catch (error) {
          console.error('‚ùå Failed to initialize WalkerOS Explorer:', error);
        }
      });
    </script>
  </body>
</html>
