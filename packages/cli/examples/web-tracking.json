{
  "flow": {
    "platform": "web",
    "sources": {
      "browser": {
        "code": "sourceBrowser",
        "config": {
          "settings": {
            "pageview": true,
            "session": true
          }
        }
      }
    },
    "destinations": {
      "api": {
        "code": "destinationAPI",
        "config": {
          "settings": {
            "url": "http://localhost:8080/collect",
            "method": "POST",
            "transport": "fetch"
          }
        }
      },
      "gtag": {
        "code": "destinationGtag",
        "config": {
          "settings": {
            "ga4": {
              "measurementId": "${GA4_MEASUREMENT_ID:G-XXXXXXXXXX}"
            }
          },
          "mapping": {
            "page": {
              "view": {
                "name": "page_view",
                "data": {
                  "map": {
                    "page_title": "data.title",
                    "page_location": "data.url",
                    "page_path": "data.path"
                  }
                }
              }
            },
            "product": {
              "view": {
                "name": "view_item",
                "data": {
                  "map": {
                    "currency": { "value": "USD" },
                    "value": "data.price",
                    "items": {
                      "loop": [
                        "data",
                        {
                          "map": {
                            "item_id": "id",
                            "item_name": "name",
                            "price": "price"
                          }
                        }
                      ]
                    }
                  }
                }
              },
              "add": {
                "name": "add_to_cart",
                "data": {
                  "map": {
                    "currency": { "value": "USD" },
                    "value": "data.price",
                    "items": {
                      "loop": [
                        "data",
                        {
                          "map": {
                            "item_id": "id",
                            "item_name": "name",
                            "price": "price",
                            "quantity": "quantity"
                          }
                        }
                      ]
                    }
                  }
                }
              }
            },
            "order": {
              "complete": {
                "name": "purchase",
                "data": {
                  "map": {
                    "transaction_id": "data.id",
                    "currency": { "value": "USD" },
                    "value": "data.total",
                    "items": {
                      "loop": [
                        "nested.product",
                        {
                          "map": {
                            "item_id": "data.id",
                            "item_name": "data.name",
                            "price": "data.price",
                            "quantity": "data.quantity"
                          }
                        }
                      ]
                    }
                  }
                }
              }
            }
          }
        }
      },
      "meta": {
        "code": "destinationMeta",
        "config": {
          "settings": {
            "pixelId": "${META_PIXEL_ID:123456789}",
            "testEventCode": "${META_TEST_CODE}"
          },
          "mapping": {
            "page": {
              "view": {
                "name": "PageView"
              }
            },
            "product": {
              "view": {
                "name": "ViewContent",
                "data": {
                  "map": {
                    "content_ids": {
                      "loop": ["data.id"]
                    },
                    "content_type": { "value": "product" },
                    "value": "data.price",
                    "currency": { "value": "USD" }
                  }
                }
              },
              "add": {
                "name": "AddToCart",
                "data": {
                  "map": {
                    "content_ids": {
                      "loop": ["data.id"]
                    },
                    "content_type": { "value": "product" },
                    "value": "data.price",
                    "currency": { "value": "USD" }
                  }
                }
              }
            },
            "order": {
              "complete": {
                "name": "Purchase",
                "data": {
                  "map": {
                    "content_ids": {
                      "loop": [
                        "nested.product",
                        {
                          "map": {
                            "id": "data.id"
                          }
                        }
                      ]
                    },
                    "content_type": { "value": "product" },
                    "value": "data.total",
                    "currency": { "value": "USD" }
                  }
                }
              }
            }
          }
        }
      },
      "demo": {
        "code": "destinationDemo",
        "config": {
          "settings": {
            "name": "Browser Tracking Demo",
            "values": ["name", "data", "user", "globals"]
          }
        }
      }
    },
    "collector": {
      "run": true,
      "globals": {
        "language": "en",
        "currency": "USD"
      }
    }
  },
  "build": {
    "packages": {
      "@walkeros/collector": {
        "version": "latest",
        "imports": ["startFlow"]
      },
      "@walkeros/web-source-browser": {
        "version": "latest",
        "imports": ["sourceBrowser"]
      },
      "@walkeros/web-destination-api": {
        "version": "latest",
        "imports": ["destinationAPI"]
      },
      "@walkeros/web-destination-gtag": {
        "version": "latest",
        "imports": ["destinationGtag"]
      },
      "@walkeros/web-destination-meta": {
        "version": "latest",
        "imports": ["destinationMeta"]
      },
      "@walkeros/destination-demo": {
        "version": "latest",
        "imports": ["destinationDemo"]
      }
    },
    "minify": false,
    "globalName": "walkerOS",
    "output": "./dist/web-tracking.js"
  }
}
