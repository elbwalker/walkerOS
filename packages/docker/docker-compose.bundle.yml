# docker-compose for walkerOS Bundle Mode
# Generates a static JavaScript bundle and exits

version: '3.8'

services:
  walkeros-bundle:
    image: walkeros/docker:latest
    container_name: walkeros-bundle

    environment:
      # Required: Set operational mode
      MODE: bundle

      # Required: Flow configuration file path (built-in flows at /app/flows/)
      FLOW: /app/flows/bundle-web.json

      # Optional: Override output path
      # OUTPUT_PATH: /app/dist/walker.js

      # Optional: Enable debug logging
      # DEBUG: "true"

    volumes:
      # Mount output directory (bundle will be written here)
      - ./dist:/app/dist

      # Optional: Mount custom flow config
      # - ./my-flow.json:/app/custom.json:ro
      # Then set FLOW: /app/custom.json

    # Bundle mode exits after completion, so no restart
    restart: "no"

# Usage:
# 1. Ensure dist/ directory exists: mkdir -p dist
# 2. Run: docker-compose -f docker-compose.bundle.yml up
# 3. Check output: ls -l dist/walker.js
