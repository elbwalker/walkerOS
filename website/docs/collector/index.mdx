---
title: Collector
description: Unified event collector for web and server environments
path: /docs/collector
package: '@walkeros/collector'
sidebar_position: 2
---

import { schemas } from '@walkeros/collector/dev';

export const collectorSchema = schemas.settings;

# Collector

The collector is the central **processing engine** of walkerOS that receives
events from sources, **enriches** them with additional data, applies consent
rules, and **routes** them to destinations. It acts as the **intelligent
middleware** between event capture and event delivery.

#### What it does

The Collector transforms raw events into enriched, compliant data streams by:

* **Event processing** - Validates, normalizes, and enriches incoming events
* **Consent management** - Applies privacy rules and user consent preferences
* **Data enrichment** - Adds session data, user context, and custom properties
* **Destination routing** - Sends processed events to configured analytics
  platforms

#### Key features

* **Compatibility** - Works in both web browsers and server environments
* **Privacy-first** - Built-in consent management and data protection
* **Event validation** - Ensures data quality and consistency
* **Flexible routing** - Send events to multiple destinations simultaneously

#### Role in architecture

In the walkerOS data flow, the collector sits between sources and destinations:

```
Sources → Collector → Destinations
```

Sources capture events and send them to the collector, which processes and
routes them to your chosen destinations like Google Analytics, custom APIs, or
data warehouses.

## Installation

<CodeSnippet
  code={`npm install @walkeros/collector`}
  language="bash"
/>

## Basic setup

<CodeSnippet
  code={`import { startFlow } from '@walkeros/collector';
import { sourceBrowser } from '@walkeros/web-source-browser';

const { collector, elb } = await startFlow({
run: true,
consent: { functional: true },
sources: {
browser: {
  code: sourceBrowser,
  config: {
    settings: {
      pageview: true,
      session: true,
    },
  },
},
},
destinations: {
console: {
  code: true, // Built-in code destination
  config: {
    settings: {
      push: "console.log('Event:', event)",
    },
  },
},
},
});`}
  language="typescript"
/>

## Configuration reference

<PropertyTable schema={collectorSchema} />

## Advanced setup

<CodeSnippet
  code={`import { startFlow } from '@walkeros/collector';
import { sourceBrowser } from '@walkeros/web-source-browser';
import { destinationAPI } from '@walkeros/web-destination-api';

const { collector, elb } = await startFlow({
run: true,
consent: { functional: true },
sources: {
browser: {
  code: sourceBrowser,
  config: {
    settings: {
      pageview: true,
      session: true,
    },
  },
},
},
destinations: {
api: {
  code: destinationAPI,
  config: {
    settings: {
      url: 'https://analytics.example.com/events',
    },
  },
},
},
logger: {
level: 'DEBUG', // Show all logs (ERROR, INFO, DEBUG)
},
});`}
  language="typescript"
/>

## Event Transformation

The collector works with **mapping** to transform events as they flow through the system. Mapping is configured at the destination level and controls how walkerOS events are converted to vendor-specific formats.

```
walkerOS Event → [DESTINATION MAPPING] → Vendor Format (GA4, API, etc.)
```

For example, transforming a `product add` event into GA4's `add_to_cart`:

<CodeSnippet
  code={`destinations: {
  ga4: {
    code: destinationGtag,
    config: {
      mapping: {
        product: {
          add: {
            name: 'add_to_cart',
            data: {
              map: {
                currency: { value: 'USD' },
                value: 'data.price',
                items: { loop: ['nested', { map: { item_id: 'data.id' } }] }
              }
            }
          }
        }
      }
    }
  }
}`}
  language="typescript"
/>

[**Learn more about Mapping →**](/docs/mapping)

---

## See Also

- [**Operating Modes**](/docs/getting-started/modes) — Integrated vs Bundled approaches
- [**CLI Documentation**](/docs/apps/cli) — Configure with JSON and build with CLI
- [**Sources**](/docs/sources) — Available event capture sources
- [**Destinations**](/docs/destinations) — Available event delivery destinations
