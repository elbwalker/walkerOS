---
title: API
description: Generic HTTP API destination for sending events to custom endpoints
package: '@walkeros/web-destination-api'
path: packages/web/destinations/api
sidebar_position: 1
---

import Link from '@docusaurus/Link';
import PackageLink from '@site/src/components/docs/package-link';
import { PropertyTable, DestinationInitDemo, DestinationDemo, CodeBox } from '@walkeros/explorer';
import { getEvent } from '@walkeros/core';
import destinationWebAPI from '@walkeros/web-destination-api';
import { examples, schemas } from '@walkeros/web-destination-api';

export const destination = { ...destinationWebAPI, examples };

# API Destination

<PackageLink
  env="web"
  github="packages/web/destinations/api"
  npm="@walkeros/web-destination-api"
/>

The API destination allows you to send events to any HTTP endpoint with
customizable data transformation and transport methods.

## Installation

```bash
npm install @walkeros/web-destination-api
```

## Setup

<CodeBox
  code={`import { startFlow } from '@walkeros/collector';
import { destinationAPI } from '@walkeros/web-destination-api';

const { collector, elb } = await startFlow({
  destinations: {
    api: {
      code: destinationAPI,
      config: {
        settings: {
          url: 'https://api.example.com/events',
        },
      },
    },
  },
});`}
  disabled
  language="typescript"
  label="Code Example"
/>

## Configuration reference

<PropertyTable schema={schemas.settings} />

## Usage

### Basic Usage

<CodeBox
  code={`import { startFlow } from '@walkeros/collector';
import { destinationAPI } from '@walkeros/web-destination-api';

const { collector, elb } = await startFlow({
  destinations: {
    api: {
      code: destinationAPI,
      config: {
        settings: {
          url: 'https://api.example.com/events',
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            Authorization: 'Bearer your-token',
          },
        },
      },
    },
  },
});`}
  disabled
  language="typescript"
  label="Code Example"
/>

### Advanced Usage with Transform

<CodeBox
  code={`import { startFlow } from '@walkeros/collector';
import { destinationAPI } from '@walkeros/web-destination-api';

const { collector, elb } = await startFlow({
  destinations: {
    api: {
      code: destinationAPI,
      config: {
        settings: {
          url: 'https://api.example.com/events',
          transport: 'fetch',
          transform: (event, config, mapping) => {
            // Custom transformation logic
            return JSON.stringify({
              timestamp: Date.now(),
              event_name: \`\${event.entity}_\${event.action}\`,
              properties: event.data,
              context: event.context,
            });
          },
        },
      },
    },
  },
});`}
  disabled
  language="typescript"
  label="Code Example"
/>

## Examples

### Sending to Analytics API

<CodeBox
  code={`import { startFlow } from '@walkeros/collector';
import { destinationAPI } from '@walkeros/web-destination-api';

const { collector, elb } = await startFlow({
  destinations: {
    api: {
      code: destinationAPI,
      config: {
        settings: {
          url: 'https://analytics.example.com/track',
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-API-Key': 'your-api-key',
          },
          transform: (event) => {
            return JSON.stringify({
              event_type: \`\${event.entity}_\${event.action}\`,
              user_id: event.user?.id,
              session_id: event.user?.session,
              properties: event.data,
              timestamp: event.timing,
            });
          },
        },
      },
    },
  },
});`}
  disabled
  language="typescript"
  label="Code Example"
/>

### Using Beacon Transport

For critical events that need to be sent even when the page is unloading:

<CodeBox
  code={`// Add to existing startFlow config
const { collector, elb } = await startFlow({
  destinations: {
    criticalApi: {
      code: destinationAPI,
      config: {
        settings: {
          url: 'https://api.example.com/critical-events',
          transport: 'beacon', // Reliable for page unload scenarios
        },
      },
    },
  },
});`}
  disabled
  language="typescript"
  label="Code Example"
/>

### Custom Data Mapping

Use mapping rules to control which events are sent:

<CodeBox
  code={`// Add to existing startFlow config
const { collector, elb } = await startFlow({
  destinations: {
    api: {
      code: destinationAPI,
      config: {
        settings: {
          url: 'https://api.example.com/events',
        },
        mapping: {
          entity: {
            action: {
              data: 'data',
            },
          },
        },
      },
    },
  },
});`}
  disabled
  language="typescript"
  label="Code Example"
/>

## Transport Methods

- **fetch** (default): Modern, promise-based HTTP requests
- **xhr**: Traditional XMLHttpRequest for older browser compatibility
- **beacon**: Uses Navigator.sendBeacon() for reliable data transmission during
  page unload

## Mapping

By default the&nbsp;<Link to="/docs/core/web#sendweb">`sendWeb`</Link> function
is used to send the events to an API.

<DestinationDemo
  destination={destination}
  settings={{
    url: 'https://api.example.com/events',
  }}
  smallText={true}
  height={'128px'}
  event={getEvent()}
  mapping={examples.mapping.entity_action}
  generic={true}
/>
