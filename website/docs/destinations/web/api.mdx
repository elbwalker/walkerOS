---
title: API
description: Generic HTTP API destination for sending events to custom endpoints
tags: [web, destination, api, http]
package: '@walkeros/web-destination-api'
path: packages/web/destinations/api
sidebar_position: 1
---

import PackageLink from '@site/src/components/docs/package-link';
import SettingsTable from '@site/src/components/molecules/SettingsTable';

# API Destination

<PackageLink
  env="web"
  github="packages/web/destinations/api"
  npm="@walkeros/web-destination-api"
/>

The API destination allows you to send events to any HTTP endpoint with
customizable data transformation and transport methods.

## Installation

```bash
npm install @walkeros/web-destination-api
```

## Quick Start

```typescript
import { createCollector } from '@walkeros/collector';
import { destinationAPI } from '@walkeros/web-destination-api';

const { elb } = await createCollector();

elb('walker destination', destinationAPI, {
  settings: {
    url: 'https://api.example.com/events',
  },
});
```

## Configuration

<SettingsTable
  properties={[
    {
      name: 'url',
      type: 'string',
      description: 'The HTTP endpoint URL to send events to',
      required: true,
      example: "'https://api.example.com/events'",
    },
    {
      name: 'headers',
      type: 'Record<string, string>',
      description: 'Additional HTTP headers to include with requests',
      required: false,
      example:
        "{ 'Authorization': 'Bearer token', 'Content-Type': 'application/json' }",
    },
    {
      name: 'method',
      type: 'string',
      description: 'HTTP method for the request',
      required: false,
      example: "'POST'",
    },
    {
      name: 'transform',
      type: 'function',
      description: 'Function to transform event data before sending',
      required: false,
      example: '(data, config, mapping) => JSON.stringify(data)',
    },
    {
      name: 'transport',
      type: "'fetch' | 'xhr' | 'beacon'",
      description: 'Transport method for sending requests',
      required: false,
      example: "'fetch'",
    },
  ]}
/>

## Usage

### Basic Usage

```typescript
import { createCollector } from '@walkeros/collector';
import { destinationAPI } from '@walkeros/web-destination-api';

const { elb } = await createCollector();

elb('walker destination', destinationAPI, {
  settings: {
    url: 'https://api.example.com/events',
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      Authorization: 'Bearer your-token',
    },
  },
});
```

### Advanced Usage with Transform

```typescript
import { createCollector } from '@walkeros/collector';
import { destinationAPI } from '@walkeros/web-destination-api';

const { elb } = await createCollector();

elb('walker destination', destinationAPI, {
  settings: {
    url: 'https://api.example.com/events',
    transport: 'fetch',
    transform: (event, config, mapping) => {
      // Custom transformation logic
      return JSON.stringify({
        timestamp: Date.now(),
        event_name: `${event.entity}_${event.action}`,
        properties: event.data,
        context: event.context,
      });
    },
  },
});
```

## Examples

### Sending to Analytics API

```typescript
import { createCollector } from '@walkeros/collector';
import { destinationAPI } from '@walkeros/web-destination-api';

const { elb } = await createCollector();

// Configure for analytics API
elb('walker destination', destinationAPI, {
  settings: {
    url: 'https://analytics.example.com/track',
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-API-Key': 'your-api-key',
    },
    transform: (event) => {
      return JSON.stringify({
        event_type: `${event.entity}_${event.action}`,
        user_id: event.user?.id,
        session_id: event.user?.session,
        properties: event.data,
        timestamp: event.timing,
      });
    },
  },
});
```

### Using Beacon Transport

For critical events that need to be sent even when the page is unloading:

```typescript
elb('walker destination', destinationAPI, {
  settings: {
    url: 'https://api.example.com/critical-events',
    transport: 'beacon', // Reliable for page unload scenarios
  },
});
```

### Custom Data Mapping

Use mapping rules to control which events are sent:

```typescript
elb('walker destination', destinationAPI, {
  settings: {
    url: 'https://api.example.com/events',
  },
  mapping: {
    entity: {
      action: {
        data: 'data',
      },
    },
  },
});
```

## Transport Methods

- **fetch** (default): Modern, promise-based HTTP requests
- **xhr**: Traditional XMLHttpRequest for older browser compatibility
- **beacon**: Uses Navigator.sendBeacon() for reliable data transmission during
  page unload
