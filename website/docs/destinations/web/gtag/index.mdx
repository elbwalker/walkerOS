---
title: Google Gtag (Unified)
description: Unified Google destination supporting GA4, Google Ads, and GTM through a single gtag implementation
sidebar_position: 1
---

# Google Gtag (Unified)

The unified Google destination for walkerOS that supports **Google Analytics 4 (GA4)**, **Google Ads**, and **Google Tag Manager (GTM)** through a single, efficient gtag implementation.

## Overview

Instead of managing three separate packages, the gtag destination consolidates all Google tools into one unified package with:

- **Shared Script Loading**: Single gtag script shared across all Google tools
- **Unified Configuration**: Configure multiple Google tools in one destination
- **Tool-Specific Mappings**: Individual mapping configurations for each tool
- **Better Performance**: Eliminates duplicate script loading and reduces bundle size
- **Type Safety**: Full TypeScript support with strict typing

## Quick Start

### Installation

```bash
npm install @walkerOS/web-destination-gtag
```

### Basic Setup

```typescript
import { collector } from '@walkerOS/collector';
import { destinationGtag } from '@walkerOS/web-destination-gtag';

const instance = collector({
  destinations: [
    destinationGtag({
      settings: {
        ga4: {
          measurementId: 'G-XXXXXXXXXX',
        },
        ads: {
          conversionId: 'AW-XXXXXXXXX',
        },
        gtm: {
          containerId: 'GTM-XXXXXXX',
        },
      },
    }),
  ],
});
```

## Complete Multi-Tool Example

Here's a comprehensive example showing all three Google tools configured together for an e-commerce site:

```typescript
import { collector } from '@walkerOS/collector';
import { sourceBrowser } from '@walkerOS/web-source-browser';
import { destinationGtag } from '@walkerOS/web-destination-gtag';

// Initialize collector with unified Google destination
const instance = collector({
  destinations: [
    destinationGtag({
      settings: {
        // Google Analytics 4 configuration
        ga4: {
          measurementId: 'G-XXXXXXXXXX',
          debug: process.env.NODE_ENV === 'development',
          include: ['data', 'context', 'user'],
          pageview: true,
          snakeCase: true,
        },
        // Google Ads configuration
        ads: {
          conversionId: 'AW-XXXXXXXXX',
          currency: 'USD',
        },
        // Google Tag Manager configuration
        gtm: {
          containerId: 'GTM-XXXXXXX',
          dataLayer: 'dataLayer', // Custom dataLayer name if needed
        },
      },
      // Tool-specific event mappings
      mapping: {
        // E-commerce purchase event
        order: {
          complete: {
            name: 'purchase', // Event name for GA4 and GTM
            settings: {
              ga4: {
                include: ['data', 'context'],
              },
              ads: {
                label: 'PURCHASE_CONVERSION', // Google Ads conversion label
              },
              gtm: {}, // Sends to GTM dataLayer
            },
            data: {
              map: {
                // Common fields for all tools
                transaction_id: 'data.id',
                value: 'data.total',
                tax: 'data.taxes',
                shipping: 'data.shipping',
                currency: { key: 'data.currency', value: 'USD' },
                // Enhanced e-commerce items
                items: {
                  loop: [
                    'nested',
                    {
                      condition: (entity) => entity.type === 'product',
                      map: {
                        item_id: 'data.id',
                        item_name: 'data.name',
                        item_category: 'data.category',
                        quantity: { key: 'data.quantity', value: 1 },
                        price: 'data.price',
                      },
                    },
                  ],
                },
              },
            },
          },
        },
        // Product view event
        product: {
          view: {
            name: 'view_item',
            settings: {
              ga4: { include: ['data'] },
              ads: {}, // No conversion tracking for product views
              gtm: {},
            },
            data: {
              map: {
                item_id: 'data.id',
                item_name: 'data.name',
                item_category: 'data.category',
                value: 'data.price',
                currency: 'data.currency',
              },
            },
          },
          // Add to cart event
          add: {
            name: 'add_to_cart',
            settings: {
              ga4: { include: ['data'] },
              ads: {}, // No conversion tracking for add to cart
              gtm: {},
            },
            data: {
              map: {
                currency: { value: 'USD', key: 'data.currency' },
                value: 'data.price',
                items: {
                  loop: [
                    'this',
                    {
                      map: {
                        item_id: 'data.id',
                        item_name: 'data.name',
                        item_variant: 'data.variant',
                        quantity: { value: 1, key: 'data.quantity' },
                        price: 'data.price',
                      },
                    },
                  ],
                },
              },
            },
          },
        },
      },
    }),
  ],
});

// Add browser source for DOM tracking
const { elb } = sourceBrowser(instance, {
  // Browser source configuration
});

// The elb object is now available for programmatic event triggering
elb.page('homepage');
```

## Key Benefits

### **1. Simplified Management**
- Single package instead of three separate ones
- Unified dependency management
- Consistent API across all Google tools

### **2. Performance Optimization**
- Shared gtag script loading prevents conflicts
- Reduced bundle size through code deduplication
- Efficient resource utilization

### **3. Developer Experience**
- Single configuration object for all tools
- Tool-specific mapping support
- Comprehensive TypeScript support
- Unified documentation and examples

### **4. Flexibility**
- Use one, two, or all three Google tools
- Easy to add or remove tools
- Tool-specific configuration options

## Next Steps

Explore the individual tool documentation for detailed configuration options:

- **[Google Analytics 4 (GA4)](./ga4)** - Advanced web analytics and reporting
- **[Google Ads](./ads)** - Conversion tracking and remarketing
- **[Google Tag Manager (GTM)](./gtm)** - Tag management and custom tracking

## Migration

If you're currently using individual Google destination packages, see our [migration guide](../../../migrations/elbwalker_to_walkeros#google-package-consolidation) for step-by-step instructions on migrating to the unified gtag destination.