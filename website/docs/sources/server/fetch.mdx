---
title: Fetch
description: Web Standard Fetch API source for edge and serverless platforms
sidebar_position: 2
package: '@walkeros/server-source-fetch'
---

<PackageLink env="server" github="packages/server/sources/fetch" npm="@walkeros/server-source-fetch" />

# Fetch

Web Standard Fetch API source for walkerOS - deploy to any modern edge or serverless platform.

## Features

* **Platform agnostic**: Cloudflare Workers, Vercel Edge, Deno, Bun, Node.js 18+
* **Web Standard**: Native `(Request) => Response` signature
* **Batch processing**: Handle multiple events in single request
* **CORS support**: Configurable cross-origin resource sharing
* **Pixel tracking**: 1x1 transparent GIF for GET requests

## Installation

<CodeSnippet
  code={`npm install @walkeros/server-source-fetch`}
  language="bash"
/>

## Platform examples

### Cloudflare Workers

<CodeSnippet
  code={`import { sourceFetch } from '@walkeros/server-source-fetch';
import { startFlow } from '@walkeros/collector';

const { sources } = await startFlow({
  sources: {
    fetch: {
      code: sourceFetch,
      config: {
        settings: { path: '/collect', cors: true },
      },
    },
  },
});

export default { fetch: sources.fetch.push };`}
  language="typescript"
/>

### Vercel Edge

<CodeSnippet
  code={`// api/collect.ts
export const config = { runtime: 'edge' };

import { sourceFetch } from '@walkeros/server-source-fetch';
import { startFlow } from '@walkeros/collector';

const { sources } = await startFlow({
  sources: {
    fetch: { code: sourceFetch, config: {} },
  },
});

export default sources.fetch.push;`}
  language="typescript"
/>

### Deno Deploy

<CodeSnippet
  code={`import { sourceFetch } from '@walkeros/server-source-fetch';
import { startFlow } from '@walkeros/collector';

const { sources } = await startFlow({
  sources: {
    fetch: { code: sourceFetch, config: {} },
  },
});

Deno.serve(sources.fetch.push);`}
  language="typescript"
/>

### Bun

<CodeSnippet
  code={`import { sourceFetch } from '@walkeros/server-source-fetch';
import { startFlow } from '@walkeros/collector';

const { sources } = await startFlow({
  sources: {
    fetch: { code: sourceFetch, config: {} },
  },
});

Bun.serve({ fetch: sources.fetch.push, port: 3000 });`}
  language="typescript"
/>

## Configuration

| Setting | Type | Default | Description |
|---------|------|---------|-------------|
| `path` | `string` | `/collect` | Collection endpoint path |
| `cors` | `boolean \| object` | `true` | CORS configuration |
| `healthPath` | `string` | `/health` | Health check endpoint |
| `maxRequestSize` | `number` | `102400` | Max request size in bytes (100KB) |
| `maxBatchSize` | `number` | `100` | Max events per batch request |

## Ingest Metadata

Extract request metadata and forward it through the pipeline.

<CodeSnippet
  code={`const { sources } = await startFlow({
  sources: {
    fetch: {
      code: sourceFetch,
      config: {
        settings: { cors: true },
        ingest: {
          ua: { fn: (req) => req.headers.get('user-agent') },
          origin: { fn: (req) => req.headers.get('origin') },
          url: 'url',
        },
      },
    },
  },
});`}
  language="typescript"
/>

### Available Ingest Paths

| Path | Description |
|------|-------------|
| `url` | Full request URL |
| `headers.get('name')` | Via function: `{ fn: (req) => req.headers.get('name') }` |

:::note
The Fetch API uses `Request` objects where headers are accessed via `.get()` method. Use mapping functions for header extraction.
:::

## Usage

### Single Event

<CodeSnippet
  code={`fetch('https://your-endpoint.com/collect', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    name: 'page view',
    data: { title: 'Home', path: '/' },
  }),
});`}
  language="javascript"
/>

### Batch Events

<CodeSnippet
  code={`fetch('https://your-endpoint.com/collect', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    batch: [
      { name: 'page view', data: { title: 'Home' } },
      { name: 'button click', data: { id: 'cta' } },
    ],
  }),
});`}
  language="javascript"
/>
