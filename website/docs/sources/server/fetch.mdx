---
title: Fetch
description: Web Standard Fetch API source for edge and serverless platforms
sidebar_position: 2
package: '@walkeros/server-source-fetch'
---

import { schemas } from '@walkeros/server-source-fetch/dev';

<PackageLink env="server" github="packages/server/sources/fetch" npm="@walkeros/server-source-fetch" />

# Fetch

Web Standard Fetch API source for walkerOS - deploy to any modern edge or serverless platform.

:::info Where This Fits
The Fetch Source is a **server source** in the walkerOS flow:

<FlowMap
  sources={{ default: { label: 'Source', text: 'Fetch', highlight: true } }}
  collector={{ highlight: false }}
  destinations={{ default: { highlight: false } }}
/>

It receives events via the Fetch API and forwards them to your destinations. Works on any platform supporting Web Standards.
:::

## Features

* **Platform agnostic**: Cloudflare Workers, Vercel Edge, Deno, Bun, Node.js 18+
* **Web Standard**: Native `(Request) => Response` signature
* **Batch processing**: Handle multiple events in single request
* **CORS support**: Configurable cross-origin resource sharing
* **Pixel tracking**: 1x1 transparent GIF for GET requests

## Installation

<CodeSnippet
  code={`npm install @walkeros/server-source-fetch`}
  language="bash"
/>

:::caution path setting renamed to paths
The `path` setting has been renamed to `paths` (array). The old `path` still works but is deprecated and will be removed in the next major version.

```typescript
// Before (deprecated)
settings: { path: '/events' }

// After
settings: { paths: ['/events'] }
```
:::

## Quick start

<Tabs groupId="mode">
  <TabItem value="integrated" label="Integrated" default>

### Cloudflare Workers

<CodeSnippet
  code={`import { sourceFetch } from '@walkeros/server-source-fetch';
import { startFlow } from '@walkeros/collector';

const { sources } = await startFlow({
  sources: {
    fetch: {
      code: sourceFetch,
      config: {
        settings: { paths: ['/collect'], cors: true },
      },
    },
  },
});

export default { fetch: sources.fetch.push };`}
  language="typescript"
/>

  </TabItem>
  <TabItem value="bundled" label="Bundled">

Add to your `flow.json` sources:

<CodeSnippet
  code={`"sources": {
  "fetch": {
    "package": "@walkeros/server-source-fetch",
    "config": {
      "settings": {
        "paths": ["/collect"],
        "cors": true
      }
    }
  }
}`}
  language="json"
/>

Server sources require platform-specific handlers. For containerized deployments, see [Docker →](/docs/apps/docker).

[See Bundled Mode setup →](/docs/getting-started/modes/bundled) | [CLI reference →](/docs/apps/cli)

  </TabItem>
</Tabs>

## More platform examples

The following examples show Integrated mode patterns for various platforms:

### Vercel Edge

<CodeSnippet
  code={`// api/collect.ts
export const config = { runtime: 'edge' };

import { sourceFetch } from '@walkeros/server-source-fetch';
import { startFlow } from '@walkeros/collector';

const { sources } = await startFlow({
  sources: {
    fetch: { code: sourceFetch, config: {} },
  },
});

export default sources.fetch.push;`}
  language="typescript"
/>

### Deno Deploy

<CodeSnippet
  code={`import { sourceFetch } from '@walkeros/server-source-fetch';
import { startFlow } from '@walkeros/collector';

const { sources } = await startFlow({
  sources: {
    fetch: { code: sourceFetch, config: {} },
  },
});

Deno.serve(sources.fetch.push);`}
  language="typescript"
/>

### Bun

<CodeSnippet
  code={`import { sourceFetch } from '@walkeros/server-source-fetch';
import { startFlow } from '@walkeros/collector';

const { sources } = await startFlow({
  sources: {
    fetch: { code: sourceFetch, config: {} },
  },
});

Bun.serve({ fetch: sources.fetch.push, port: 3000 });`}
  language="typescript"
/>

## Configuration

<PropertyTable schema={schemas.settings} />

## Ingest Metadata

Extract request metadata and forward it through the pipeline.

<CodeSnippet
  code={`const { sources } = await startFlow({
  sources: {
    fetch: {
      code: sourceFetch,
      config: {
        settings: { cors: true },
        ingest: {
          ua: { fn: (req) => req.headers.get('user-agent') },
          origin: { fn: (req) => req.headers.get('origin') },
          url: 'url',
        },
      },
    },
  },
});`}
  language="typescript"
/>

### Available Ingest Paths

| Path | Description |
|------|-------------|
| `url` | Full request URL |
| `headers.get('name')` | Via function: `{ fn: (req) => req.headers.get('name') }` |

:::note
The Fetch API uses `Request` objects where headers are accessed via `.get()` method. Use mapping functions for header extraction.
:::

## Usage

### Single Event

<CodeSnippet
  code={`fetch('https://your-endpoint.com/collect', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    name: 'page view',
    data: { title: 'Home', path: '/' },
  }),
});`}
  language="javascript"
/>

### Batch Events

<CodeSnippet
  code={`fetch('https://your-endpoint.com/collect', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    batch: [
      { name: 'page view', data: { title: 'Home' } },
      { name: 'button click', data: { id: 'cta' } },
    ],
  }),
});`}
  language="javascript"
/>
